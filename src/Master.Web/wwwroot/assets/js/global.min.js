function L(n){return abp.localization.localize(n)}function getEvent(){var t,n;if(document.all)return window.event;for(t=getEvent.caller;t!==null&&t.arguments;){if(n=t.arguments[0],n&&(n.constructor===Event||n.constructor===MouseEvent||typeof n=="object"&&n.preventDefault&&n.stopPropagation))return n;t=t.caller}return null}function getCheckboxValue(n){var t=[];return $(":checked[name='"+n+"']").each(function(){t.push($(this).val())}),t}function Full(){var n=$("#LAY_app_tabs").offset().left;console.log(n);n>0?($("#LAY_app_tabs").addClass("quanping-tabs"),$("#LAY_app_body").addClass("quanping-body")):n==0&&($("#LAY_app_tabs").removeClass("quanping-tabs"),$("#LAY_app_body").removeClass("quanping-body"))}var config={layuiBase:"/assets/layuiadmin/",layuiIndex:"lib/index",layuiExtends:{authtree:"lib/extend/authtree",ztree:"lib/extend/ztree/ztree",droptree:"lib/extend/droptree",formSelects:"../lib/extend/formselects/formSelects-v4",tableSelect:"../lib/extend/tableselect/tableSelect",treeGrid:"../lib/extend/treegrid/treegrid",verifyInit:"../lib/extend/verifyInit/verifyInit",multiSelect:"../lib/extend/multiSelect/multiSelect",suggest:"../lib/extend/suggest/suggest",soulTable:"../lib/extend/soulTable/soulTable"},layuiModules:["index","table","layer","form","element","laydate","tree","upload","colorpicker","formSelects","tableSelect","verifyInit","multiSelect","suggest","soulTable"],ready:function(){console.log("onready not implemented")},readyFuncs:[],onTableDone:function(n,t,i){config.onTableDoneExport(n,t,i);console.log("onTableDone not implemented")},onTableDoneExport:function(){},tableRowdone:function(){},tableCheckBoxdone:function(){},reloadTable:function(){console.log("reloadTable not implemented")},refresh:function(){console.log("refresh not implemented")},showSearchForm:function(n){var t="/ModuleData/Search?moduleKey="+n;layer.open({type:2,title:L("检索"),closeBtn:1,shade:.1,shadeClose:!0,area:["600px","100%"],offset:"l",anim:3,content:[t],end:function(){}})},showRelativeModuleForm:function(n){var t=n.moduleKey,i=n.columnKey,r=n.maxReferenceNumber||1,u="/ModuleData/RelativeSelect?moduleKey="+t+"&columnKey="+i+"&maxReferenceNumber"+r;window.referenceLayerIndex=layer.open({type:2,title:L("关联查询"),closeBtn:1,shade:.1,shadeClose:!0,area:["80%","100%"],offset:"r",anim:0,content:[u],end:function(){}})}},func,layuiExt;(function(){const n=Array.prototype,t=Object.create(n);Object.defineProperty(t,"push",{value:function(){const i=n.push;let t=Array.from(arguments);if(func.typeof(t[0])=="function")i.apply(this,t);else{console.warn("往这个数组里传非函数类型的，将无效！");return}config.readyFuncs.hadRun&&(t[0](),console.warn("layui的use已完成，这个数组已经遍历运行过了，直接执行吧！"))}});config.readyFuncs.__proto__=t})();$(function(){function n(n){var t=n.target.tagName.toLowerCase(),i;(t=="input"||t=="textarea")&&(i=n.key?n.key.toLowerCase():"",i=="z"&&n.altKey&&$(n.target).val($(n.target).val()+"φ"))}document.addEventListener("keyup",n);$("body").on("mouseenter","*[tips]",function(){var n;if(layer){if(n=$(this),!n.attr("tips"))return;var i=n.attr("tips"),t=n.attr("lay-offset"),r=n.attr("lay-direction"),u=n.attr("lay-background"),f=n.attr("lay-area"),e=layer.tips(i,this,{tips:[r||1,u||"#000"],time:-1,anim:-1,maxWidth:f||"",success:function(n){t&&n.css("margin-left",t+"px")}});n.data("index",e)}}).on("mouseleave","*[tips]",function(){layer&&layer.close($(this).data("index"))});$("body").on("mouseenter","*[formtips]",function(){var n=$(this);if(n.attr("formtips")){var i=n.attr("formtips"),r=n.attr("lay-background"),t=n.attr("lay-offset"),u=n.attr("lay-direction"),f=layer.tips(i,this,{tips:[u||1,r||"#FFB800"],time:-1,success:function(n){t&&n.css("margin-left",t+"px");n.css("width","auto");n.css("max-width","600px")}});n.data("index",f)}}).on("mouseleave","*[formtips]",function(){layer.close($(this).data("index"))});$("body").on("mouseenter","*[timetips]",function(){function u(){if(layer){if(!n.attr("timetips"))return;var u=n.attr("timetips"),r=n.attr("lay-offset"),f=n.attr("lay-direction"),e=n.attr("lay-background"),o=n.attr("lay-area");t=layer.tips(u,i,{tips:[f||1,e||"#000"],time:-1,anim:-1,maxWidth:o||"",success:function(n){r&&n.css("margin-left",r+"px")}})}}var i=this,n=$(this),t,r=setTimeout(function(){u()},500);n.on("mouseleave",function(){layer&&layer.close(t);clearTimeout(r)})});$("body").on("click",".laydialog",function(){var n=$(this),i=n.attr("url"),r,t;i.indexOf("http")==0||i.indexOf("/")==0?(r=2,t=n.attr("url")):(r=1,t=$(i),console.log(t));layer.open({type:r,shade:.8,shadeClose:!0,title:n.attr("title")||n.text(),area:[n.attr("width")||"80%",n.attr("height")||"80%"],content:t})});func.initUI();$("body").on("click","img.thumb",function(){var n=$(this),r=n.attr("FileID"),t=/(.*?)(?:[\?&]w=\d+)|(.*)/.exec(n.attr("src")),i=t[1]||t[2];layuiExt.fLayerImg("",i)});$("table[module]").each(function(){var n=$(this).attr("module");layui.sessionData(n,null)})});func={"typeof":function(n){if(arguments.length===0)return new Error("type方法未传参");var t=Object.prototype.toString.call(n);return t.match(/\[object (.*?)\]/)[1].toLowerCase()},array:{distinct:function(){return this.reduce(function(n,t){return n.indexOf(t)==-1&&n.push(t),n},[])}},splitDrag:function(n,t,i={}){var r,u;$.extend(i,{left:10,right:500});r=t.parent();r=i.wrap?typeof i.wrap=="string"?$(i.wrap):i.wrap:r;r.append('<div id="r-treedrag"><div id="r-treedrag-ul">\n <\/div>\n <div id="r-treedrag-width"><\/div>\n <div id="r-treedrag-table">\n <div class="r-treedrag-table_wrap">\n <\/div>\n  <\/div>\n <\/div>');$("#r-treedrag-ul").append(n);$(".r-treedrag-table_wrap").append(t);u=layui.data("manyChangeWidth")[i.key];u?$("#r-treedrag-ul").width(u):layui.data("manyChangeWidth",{key:i.key,value:"250"}),function(){var n=document.getElementById("r-treedrag-width"),t=0;n.onmousedown=function(r){var f=r||event,u;return t=f.clientX-n.offsetLeft,u=$(".r-treedrag").outerWidth(!0)-$(".r-treedrag").width()/2,console.log(u),document.onmousemove=function(n){var f=n||event,r=f.clientX-t-u;r<i.left?r=i.left:r>i.right&&(r=i.right);$("#r-treedrag-ul").width(r);layui.data("manyChangeWidth",{key:i.key,value:r})},document.onmouseup=function(){document.onmousemove=null;document.onmouseup=null},!1}}()},getFeeTypeByNum:function(n){return{0:"承包",1:"按时间",2:"按平方",3:"按长度",4:"按重量",5:"按数量"}[n]||""},makeQueryArray:function(){console.log("处理array类型的高级查询")},makeQuery:function(n){for(var o,s,f,r,h,c,e,u,t="",i=0;i<n.length;i++){n[i].key=n[i].key.replace("，",",");n[i].data=n[i].data.replace("，",",");o=n[i].key.split(",");s=o[0].substring(0,o[0].lastIndexOf("."));function l(n,i){for(var e=n.split(","),f={Like:['.Contains("','")'],other:[' = "','"']},u=0;u<e.length;u++)t=u==0?t+" ("+r+f[i][0]+e[u]+f[i][1]:t+" or "+r+f[i][0]+e[u]+f[i][1];t=t+")"}for(t=t+" and (",f=0;f<o.length;f++)if(r="",r=f==0?o[f]:s!=""?s+"."+o[f]:o[f],n[i].canAnd)n[i].type=="Date"?(n[i].data.split("|"),h=n[i].data.split("|")[0],c=n[i].data.split("|")[1],t=t+" "+r+'>="'+h+'" and '+r+'<="'+c+'" '):console.log("canAnd为true，且不为时间类型");else if(n[i].type=="Array"||n[i].type=="Check")console.log(func.makeQueryArray(n[i]),t+func.makeQueryArray(n[i])),t=t+func.makeQueryArray(n[i]);else if(n[i].type=="Like")f!=0&&(t+=" or "),l(n[i].data,"Like");else if(f==0){for(e=n[i].data.split(","),u=0;u<e.length;u++)t=u==0?t+" ("+r+' = "'+e[u]+'"':t+" or "+r+' = "'+e[u]+'"';t=t+")"}else{for(e=n[i].data.split(","),u=0;u<e.length;u++)t=u==0?t+" or ("+r+' = "'+e[u]+'"':t+" or "+r+' = "'+e[u]+'"';t=t+")"}t=t+")"}return t},getHandleDate:function(n,t){function a(n){var t=0;return 2<n&&n<6&&(t=3),5<n&&n<9&&(t=6),n>8&&(t=9),t}function s(n=i){var t=n.getFullYear(),r=n.getMonth()+1;return new Date(t,r,0)}function r(n){var r=n.getFullYear(),t=n.getMonth()+1,i=n.getDate();return t<10&&(t="0"+t),i<10&&(i="0"+i),r+"-"+t+"-"+i}var l={sp:" | "};$.extend(l,n);n=l;n.type=n.type.toLowerCase();var i=t||new Date,o=i.getFullYear(),u=i.getMonth(),h=i.getDate(),c=i.getDay(),f,e;switch(n.type){case"本月":f=r(new Date(o,u,1));e=r(s(i));break;case"上月":i.setMonth(i.getMonth()-1);o=i.getFullYear();u=i.getMonth();f=r(new Date(o,u,1));e=r(s(i));break;case"本周":f=r(new Date(o,u,h-c));e=r(new Date(o,u,h-c+6));break;case"上周":f=r(new Date(o,u,h-c-7));e=r(new Date(o,u,h-c+6-7));break;case"本季":u=a(u);f=r(new Date(o,u,1));i.setMonth(u+2);e=r(s(i));break;case"上季":i.setFullYear(o,u-3,1);u=a(i.getMonth());f=r(new Date(i.getFullYear(),u,1));i.setMonth(u+2);e=r(s(i));break;case"本年":f=r(new Date(o,0,1));i=new Date(i.setMonth(11));e=r(s(i));break;case"上年":f=r(new Date(o-1,0,1));i=new Date(i.setFullYear(o-1,11));e=r(s(i));break;case"今天":f=e=r(i);break;case"昨天":f=e=r(new Date(i.getTime()-864e5));break;case"近14天":e=r(i);f=r(new Date(i.getTime()-12096e5));break;case"近7天":e=r(i);f=r(new Date(i.getTime()-6048e5));break;case"近3天":e=r(i);f=r(new Date(i.getTime()-2592e5));break;default:f=e=r(i)}return f+n.sp+e},formatDate:function(n,t){var t=$.extend({type:"S",split:"-"},t),e=t.split,o=n.getFullYear(),r=n.getMonth()+1,u=n.getDate(),f=o+e+(r<10?"0"+r:r)+e+(u<10?"0"+u:u),i;switch(t.type){case"S":i=f+" "+n.toTimeString().substr(0,8);break;case"M":i=f+" "+n.toTimeString().substr(0,5);break;case"H":i=f+" "+n.toTimeString().substr(0,2);break;case"Day":i=f;break;case"Mounth":i=(r<10?"0"+r:r)+e+(u<10?"0"+u:u);break;default:i=f+" "+n.toTimeString().substr(0,8)}return i},getProgressColor:function(n){return{0:"layui-bg-blue",1:"my-bg-green",2:"layui-bg-blue",3:"layui-bg-orange"}[n]},getReportType:function(n,t="tonum"){var i={"到料":1,"上机":2,"加工":3,"暂停":4,"下机":5,"重新开始":6},r;if(t=t.toLowerCase(),t=="tonum")return i[n];for(r in i)if(i[r]==n)return r},getProcessTaskStatus:function(n,t=false){var i={1:"待上机",2:"已到料",3:"加工中",4:"已完成",5:"暂停中","-1":"已取消"},r;if(t)return i[n];for(r in i)if(i[r]==n)return r},getProcessTaskStatusColor:function(n){var t;switch(n){case 0:t={color:"#dbdada",name:"未开单"};break;case 1:t={color:"#fa763b",name:"未上机"};break;case 2:t={color:"#00fdff",name:"已到料"};break;case 3:t={color:"#2699f6",name:"已上机"};break;case 4:t={color:"#75d239",name:"已完成"};break;case 5:t={color:"#fcfc00",name:"暂停中"};break;case 6:t={color:"green",name:"已对账"};break;default:t={color:"#bdbdbd",name:"其他"}}return t},judgeFileType:function(t){function r(t){/./g.test(t)&&(t=t.split("."),t=t[t.length-1]);var r,i={excal:[["excal","docx","doc","xls","xlsx"],"icon-excel","#289be5"],zip:[["zip","gzip"],"icon-yasuobao","#289be5"],pdf:[["pdf"],"icon-pdf1","#289be5"],txt:[["txt"],"icon-txt","#289be5"],video:[["mp4","avi","WAV","rm","rmvb","mpeg1","mpeg2","mpeg3","mpeg4","mov","mtv","dat","wmv","avi","3gp","amv","dmv","flv"],"icon-filevideo","#289be5"],cad:[["dwg","dwt","dxf","dws"],"icon-CAD","#289be5"],jpg:["bmp,jpg,png,tif,gif,pcx,tga,exif,fpx,svg,psd,cdr,pcd,dxf,ufo,eps,ai,raw,WMF,webp,jpeg,svg,smp".split(","),"","#289be5"]};for(n in i)i[n][0].forEach(function(u){u.toLowerCase()==t.toLowerCase()&&(r={type:n,iconfont:"iconfont "+i[n][1],color:i[n][2]})});return r?r:u}var u={type:"default",iconfont:"iconfont icon-m-fileFormat",color:"#000"},i;return t instanceof Array?(i=[],t.forEach(function(n){i.push(r(n))}),i):typeof t=="string"?r(t):void 0},renderUpload:function(n,t){var i=$.extend({trigger:"dblclick",uploadType:"single",multiple:!1},t);$("body").on(i.trigger,n,function(){try{window.upload={element:this,callback:i.callback||($(this).attr("callback")?eval($(this).attr("callback")):$.noop)};layer.open({type:2,title:"文件上传",shadeClose:!1,shade:.8,area:["500px","400px"],content:"/File/CommonUpload?multiple="+i.multiple})}catch(n){}})},getModuleServiceName:function(n){return n?n[0].toLowerCase()+n.substring(1):"moduleData"},callModuleButtonEvent:function(n){var h=getEvent(),p,o,u,s,w,b;$.isPlainObject(n)&&(n.attr=t=>n[t]);var t=n||$(h.srcElement||h.target),f=t.attr("modulekey"),nt=t.attr("lay-event"),c=t.attr("dataid"),l=t.attr("confirmmsg"),k=t.attr("title"),a=t.attr("buttonname"),e=t.attr("buttonactiontype"),v=t.attr("params"),i=t.attr("buttonactionurl"),y=t.attr("callback"),d=t.attr("opentop"),g=t.attr("fornonerow"),r=[];if(r=layui.table.checkStatus(f).data.map(function(n){return n.id||n.Id}),c)r=[c];else if(!g&&r.length===0)return abp.message.info("请先选择记录"),!1;if(p=i.indexOf("#")>0?i.split("#")[1]:"",o=i.split("#")[0]+(i.indexOf("?")>0?"&":"?")+"modulekey="+f+"&data="+r.join(",")+"#"+p,e==="Ajax"){if(s=eval(i),!s)return layer.alert("未找到代理方法"+i),!1;u=function(){func.runAsync(s(r).done(function(n){var t=!0;(y&&(t=eval(y)(n)),t)&&(parent.layer.msg("提交成功"),f&&func.reload(f))}))}}else e==="Form"?(w={type:2,title:k||a,scrollbar:!1,shadeClose:!1,shade:.8,area:["80%","80%"],content:o,btn:["提交","关闭"],btnAlign:"l",yes:function(n,t){var i=t.find("iframe")[0].contentWindow;if(i.submit)return i.submit(),!1},btn2:function(n,t){var i=t.find("iframe")[0].contentWindow;if(i.submit2)return i.submit2(),!1},btn3:function(n,t){var i=t.find("iframe")[0].contentWindow;if(i.submit3)return i.submit3(),!1}},b=v?$.parseJSON(v):{},u=function(){(d?top.layer:layer).open($.extend(w,b))}):e==="Tab"&&(u=function(){top.layui.index.openTabsPage(o,a)});l?abp.message.confirm(l,u):u()},reload:function(n,t){layui.table.reload(n,t)},runAsync:function(n){top.abp.ui.setBusy(null,n)},initForm:function(){layui.data("session").loginInfo&&$.extend(abp.session,JSON.parse(layui.data("session").loginInfo));$("div.layui-inline").each(function(){var t=$(this).parent(),n=$(this).prev();t.is(".layui-form-item")||(n.is(".layui-form-item")?$(this).appendTo(n):$(this).wrap('<div class="layui-form-item"><\/div>'))});$("table[lay-filter]").each(function(){var n=$(this).attr("lay-filter");layui.table.on("row("+n+")",function(n){$(n.tr).hasClass("my-table-active")?$(n.tr).removeClass("my-table-active"):($(n.tr).addClass("my-table-active"),$(n.tr).siblings().removeClass("my-table-active"));config.tableRowdone(n)});layui.table.on("checkbox("+n+")",function(t){t.type=="all"?t.checked?$('[lay-filter="'+n+'"]').siblings(".layui-table-view").find("tbody tr").addClass("my-table-active_checked"):$('[lay-filter="'+n+'"]').siblings(".layui-table-view").find("tbody tr").removeClass("my-table-active_checked"):t.checked?$(t.tr).addClass("my-table-active_checked"):($(t.tr).removeClass("my-table-active_checked"),$(t.tr).removeClass("my-table-active"));config.tableCheckBoxdone(t)})})},initUI:function(n){func.initLayout(n);func.renderUpload(".uploadinsert")},initLayout:function(n){var t=n||$("body");t.find("[layouth]").each(function(){var t=$(this).attr("layouth"),n=top.$(".layui-body").height();n=n-parseInt(t);$(this).css("overflow-y","auto");$(this).css("height",n+"px")})},buildSearchCondition:function(n){var t=layui.sessionData(n).conditions;return t&&t!=""?JSON.stringify(t):""},bringBack:function(n,t){var i=layui.table.checkStatus(n),r;if(i.data.length==0)return layer.msg(L("请至少选择一项"),{icon:5,anim:6}),!1;r=$.getUrlParam("key");parent.func.getBringBack(i.data,r,t)},getBringBack:function(n,t,i){func.bringBackFuncs[t](n)&&i&&layer.closeAll("iframe");console.log(n)},bringBackFuncs:[],referenceDatas:[]};abp.localization.defaultSourceName="Master";abp.auth.isGranted=function(n){return abp.auth.grantedPermissions[n]!=undefined||!abp.auth.allPermissions[n]};$.extend({randomRGB:function(n="rgb"){function t(){return parseInt(Math.random()*256)}function i(){var n=t().toString(16);return n.length==1&&n+"0",n}return n=="rgb"?"#"+i()+i()+i():`rgb(${t()},${t()},${t()})`},calWeight:function(n,t,i){var r;if(i=i||100,r=/^([\d\.]+)\s*[\*Xx]\s*([\d\.]+)\s*[\*Xx]\s*([\d\.]+)$/ig,r.test(n)){var u="0*0*0",o=n.replace(r,"$1"),s=n.replace(r,"$2"),h=n.replace(r,"$3"),c=u.replace(r,"$1"),l=u.replace(r,"$2"),a=u.replace(r,"$3"),v=parseFloat(o)+parseFloat(c),y=parseFloat(s)+parseFloat(l),p=parseFloat(h)+parseFloat(a);return Math.round(v*y*p*t/1e6*i)/i}var f=/^[Φφ]([\d\.]+)\s*[\*Xx]\s*([\d\.]+)$/ig,e=n.replace(f,"$1"),w=n.replace(f,"$2");return Math.round(e*e/4*3.14*w*t/1e6*i)/i},num2CN:function(n){var t,u,r,i;if(!/^(0|[1-9]\d*)(\.\d+)?$/.test(n))return"数据非法";for(t="京亿万仟佰拾兆万仟佰拾亿仟佰拾万仟佰拾元角分",u="",n+="00",r=n.indexOf("."),r>=0&&(n=n.substring(0,r)+n.substr(r+1,2)),t=t.substr(t.length-n.length),i=0;i<n.length;i++)u+="零壹贰叁肆伍陆柒捌玖".charAt(n.charAt(i))+t.charAt(i);return u.replace(/零(仟|佰|拾|角)/g,"零").replace(/(零)+/g,"零").replace(/零(兆|万|亿|元)/g,"$1").replace(/(兆|亿)万/g,"$1").replace(/(京|兆)亿/g,"$1").replace(/(京)兆/g,"$1").replace(/(京|兆|亿|仟|佰|拾)(万?)(.)仟/g,"$1$2零$3仟").replace(/^元零?|零分/g,"").replace(/(元|角)$/g,"$1整")},arrayToObj:function(n){for(var t,i={},r=0;r<n.length;r++)t=n[r],t.name in i?i[t.name]+=","+t.value:i[t.name]=t.value;return i},getUrlParam:function(n){var i=new RegExp("(^|&)"+n+"=([^&]*)(&|$)"),t=window.location.search.substr(1).match(i);return t!==null?decodeURIComponent(t[2]):null},newid:function(){return(new Date).getTime()+""+Math.round(Math.random()*1e3)}});layuiExt={CreatTableCondi:function(n,t,i,r,u){t=this.andOr;i=this.leftBracket;r=this.rightBracket;u=this.comparer;n=this.value},reRender:function(n,t){var r,i,u,f,e;if(t&&(r="done"in t?t.done:function(){}),i=window[n][0],u=window[n][1],window.filterArr=[],window.gudingArr=[],u[0].forEach(function(n,t){n.filterField&&filterArr.push(t);n.gudinglie!=!1&&gudingArr.push(t)}),f=i.done,i.done=function(t,u,e){f(t,u,e);typeof r=="function"&&r();i.defaultToolbar&&layuiExt.fCol(n);$(window).resize()},i=$.extend({},i,{cols:u}),console.log(i),e=layui.table,e.render(i),layuiExt.fThEvent(),i.defaultToolbar&&i.defaultToolbar.length>0){setTimeout(n,1e3);function n(){$(".layui-table-total tbody>tr").append('.<th class="layui-table-patch"><div class="layui-table-cell" style="width: 17px;"><\/div><\/th>')}}},fThEvent:function(){function e(n,t,i){$(n).each(function(n){var r=$(this);t.indexOf(n)!=-1&&r.append(i)})}function t(n,t,i,r){f(n).render(t,function(n){e(i,r,n)})}var f=layui.laytpl,n,i=filterObject.aShaiXuanDone,r=document.getElementById("colsThGuding").innerHTML,u=document.getElementById("colsThShaixuan").innerHTML;n={};t(r,n,".layui-table-header:first th",gudingArr);n.lockDone="my-colsth-done";t(r,n,".layui-table-fixed-l th",gudingArr);n={};t(u,n,".layui-table-header:first th",filterArr);t(u,n,".layui-table-fixed-l th",filterArr);typeof i!="undefined"&&i.forEach(function(n){$(".layui-table-header:first th:eq("+n+") div:last-child").addClass("my-colsth-done");$(".layui-table-fixed th:eq("+n+") div:last-child").addClass("my-colsth-done")});$("th").unbind("click");$(".layui-table-header:first th").hover(function(){$(this).find(".my-colsth-div").css("display","block")},function(){$(this).find(".my-colsth-div").css("display","none")});$(".layui-table-fixed th ").hover(function(){$(this).find(".my-colsth-shaixuan").css("display","block")},function(){$(this).find(".my-colsth-shaixuan").css("display","none")})},guDingLie:function(n){function f(){var n=[];$(".layui-table-header:first thead tr th").each(function(){n.push($(this).width())});for(let i=0;i<u;i++)t[0][i].width=n[i]}var e=layui.table,i=$(n).closest(".layui-table-view").siblings("table").attr("id"),t=window[i][1],r=$(n).parent().parent().index(),u=t[0].length;if($(n).parent().hasClass("my-colsth-done")){for(let n=r;n<u;n++)t[0][n].hasOwnProperty("fixed")&&delete t[0][n].fixed;f();layuiExt.reRender(i)}else{for(let n=0;n<=r;n++)t[0][n].fixed="left";f();e.reload(i,{cols:t});layuiExt.fThEvent()}},shaiXuanLie:function(n){function h(){$(i).hide(500,function(){$("#domSelect").remove()})}function l(){var l=window[u][0].url.split("/"),a=l[4].slice(0,1).toLowerCase().concat(l[4].slice(1));abp.services[l[3]][a].getFilterColumnPageResult({where:filterObject.whereFilter,tableFilter:JSON.stringify(filterObject.tableFilter),page:1,limit:1e3,filterField:e}).done(function(l){function g(){console.log($(".xm-select-dl").scrollTop());$(".xm-select-tips:first-child").css("top",$(".xm-select-dl").scrollTop())}function k(){var n=$(event.srcElement);console.log(n.closest("#domSelect"));$(i).hide(500,function(){$("#domSelect").remove();$("body").off("click",k)})}function d(){$(i).hide(500,function(){$("#domSelect").remove();y.removeEventListener("scroll",d)})}var a,v,p,w,b,y;l=l.filter(function(n){return n!="null"&&n!=""});a=[];filterObject.tableFilter.forEach(function(n,t){n.columnName==e&&(v=n.conditions,s=t)});l.forEach(function(n){var t=n,i;v instanceof Array?(i=v.some(function(n){return n.value==t}),i?a.push({name:t,value:t,selected:"selected"}):a.push({name:t,value:t})):a.push({name:t,value:t})});p={id:t};w=shaixuanSelect.innerHTML;c(w).render(p,function(n){$("body").append(n)});f.data(o,"local",{arr:a});f.btns(o,[{icon:"iconfont icon-016",name:"确定",click:function(i){var r,l,c,a;if(console.log(i),$(n).parent().addClass("my-colsth-done"),r=f.value(o),l=filterObject.aShaiXuanDone.indexOf(t),r.length==0&&filterObject.tableFilter.length==0)$(n).parent().removeClass("my-colsth-done"),filterObject.aShaiXuanDone.splice(l);else{r.length==0?($(n).parent().removeClass("my-colsth-done"),filterObject.aShaiXuanDone.splice(l)):($(n).parent().addClass("my-colsth-done"),filterObject.aShaiXuanDone.push(t));function i(n,t,i,r,u){t=this.andOr;i=this.leftBracket;r=this.rightBracket;u=this.comparer;n=this.value}c=[];r.forEach(function(n){c.push({value:n.name})});s==-1?filterObject.tableFilter.push({columnName:e,conditions:c}):filterObject.tableFilter[s].conditions=c;console.log(filterObject.tableFilter);a=window[u][0].where;a.tableFilter=JSON.stringify(filterObject.tableFilter);layui.table.reload(u,{where:a})}layuiExt.fThEvent();h()}},"select","remove","reverse",{icon:"iconfont icon-qingkong1",name:"取消",click:function(){h()}}],{show:"name",space:"15px"});$(".xm-select-dl").on("scroll",g);b=$(".layui-table-body").width()-290;r.left>b?$(i).offset({top:r.top+18,left:r.left-284}):$(i).offset({top:r.top+18,left:r.left+18});$(i+" .xm-form-select").addClass("xm-form-selected");$("body").on("click",k);y=document.getElementsByClassName("layui-table-body layui-table-main")[0];y.addEventListener("scroll",d,!1)})}var c=layui.laytpl,f=layui.formSelects,t=$(n).parent().index(),u=$(n).closest(".layui-table-view").siblings("table").attr("id"),e=window[u][1][0][t].filterField,i="#filterSelectOffset"+t,o="filterSelect"+t,r=$(n).offset(),s=-1;l()},fLayerImg:function(n,t,i={}){function c(){layui.layer.open({type:1,content:$("#oDiv"+r),title:!1,closeBtn:0,area:[e+"px",f+"px"],offset:["50px","50px"],skin:"layui-layer-nobg",shadeClose:!0,success:function(){oriOffset=$(`#oDiv${r}`).parent().parent().offset()}})}var f=window.innerHeight*.86,e=f*1.618,h,o,t,r,s,v,u;if(e>window.innerWidth*.86&&(e=window.innerWidth*.86),h=i.oriwidth||Math.floor(f*.8),i.oriSrc?(t=i.oriSrc,n||(r=$.newid())):(o=t.split("?")[0],t=t.split("?")[0]+"?gap=false&w="+h),n||r){var l=$(n).closest("tr").index(),a=$(n).closest("li").index(),r=l+"li"+a;console.log(r)}else s=o.split("/"),r=s[s.length-1].split(".")[0];if($(`#oImg${r}`).length==0){$(`<div id='oDiv${r}'>
                <img src='${t}'id='oImg${r}'/>
                <i class="iconfont icon-fangda my-flayerimg-icon" style="left:100px;" title="放大"></i>
                <i class="iconfont icon-suoxiao my-flayerimg-icon" style="left:140px;" title="缩小"></i>
                <i class="iconfont icon-zhongzhi my-flayerimg-icon" style="left:180px;" title="重置图片"></i>
                <i class="iconfont icon-xiangzuoxuanzhuandu my-flayerimg-icon" style="left:220px;" title="向左旋转"></i>
                <i class="iconfont icon-xiangyouxuanzhuandu my-flayerimg-icon" style="left:260px;" title="向右旋转"></i>
                <button class="layui-btn layui-btn-sm flayerimg-save" style="left:330px;position:fixed;top:16px;">保存</button>
               </div>`).appendTo($("body"));$("#oDiv"+r).css("display","none");v=document.getElementById(`oImg${r}`);function n(n,t){if(!t){n.css({width:"auto",height:"auto"});return}n.width()*t<1200&&n.width()*t>100&&(n.css("width",n.width()*t+"px"),n.css("height",n.height()*t+"px"))}$(`#oImg${r}`).on("mousewheel",function(t){var i=t.originalEvent.deltaY,u=i>0?1.2:.8;return n($(`#oImg${r}`),u),!1});$(".icon-zhongzhi.my-flayerimg-icon").on("click",function(){n($(`#oImg${r}`),!1)});$(".icon-fangda.my-flayerimg-icon").on("click",function(){n($(`#oImg${r}`),1.2)});$(".icon-suoxiao.my-flayerimg-icon").on("click",function(){n($(`#oImg${r}`),.8)});u=new CanvasImg(t);$(".icon-xiangzuoxuanzhuandu.my-flayerimg-icon").on("click",function(){$(`#oImg${r}`)[0].src=u.goRotate();console.log(u.step)});$(".icon-xiangyouxuanzhuandu.my-flayerimg-icon").on("click",function(){$(`#oImg${r}`)[0].src=u.goRotate("right");console.log(u.step)});$(".flayerimg-save").on("click",function(){$.post("/File/UploadByBase64",{data:$(`#oImg${r}`)[0].src,oriVirtualPath:o},function(n){layer.msg("保存成功");i.callback&&i.callback();console.log(n)},"json")});c()}else c()},fCol:function(n){function i(){var t=[];$(".layui-table-header").find("th").each(function(){t.push(!$(this).hasClass("layui-hide"))});t=JSON.stringify(t);window.localStorage.setItem("layTable-cols-"+n,t)}if(window.localStorage.hasOwnProperty("layTable-cols-"+n)){var t=JSON.parse(window.localStorage.getItem("layTable-cols-"+n));t.forEach(function(n,t){$('*[data-key="1-0-'+t+'"]')[n?"removeClass":"addClass"]("layui-hide")})}(function(){$('div[lay-event="LAYTABLE_COLS"]').click(function(){function r(){t.forEach(function(n,t){n||($('div[lay-event="LAYTABLE_COLS"] input[data-key="0-'+t+'"] ').siblings(".layui-form-checked").removeClass("layui-form-checked"),$('div[lay-event="LAYTABLE_COLS"] input[data-key="0-'+t+'"]').click())})}function n(t){$(t.target).closest("[lay-event='LAYTABLE_COLS']").length||(i(),$(document).off("click",n))}setTimeout(r,0);$(document).on("click",n)})})();window.addEventListener("unload",()=>{i()})}};Date.prototype.pattern=function(n){var i={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()},t;/(y+)/.test(n)&&(n=n.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));/(E+)/.test(n)&&(n=n.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"/u661f/u671f":"/u5468":"")+{"0":"/u65e5","1":"/u4e00","2":"/u4e8c","3":"/u4e09","4":"/u56db","5":"/u4e94","6":"/u516d"}[this.getDay()+""]));for(t in i)new RegExp("("+t+")").test(n)&&(n=n.replace(RegExp.$1,RegExp.$1.length==1?i[t]:("00"+i[t]).substr((""+i[t]).length)));return+this==0||isNaN(+this)?"":n};Date.prototype.addDay=function(n=1,t="d",i){switch(t.toLowerCase()){case"y":this.setFullYear(this.getFullYear()+n);break;case"m":this.setMonth(this.getMonth()+n);break;case"d":this.setDate(this.getDate()+n);break;case"w":this.setDate(this.getDate()+7*n);break;case"h":this.setHours(this.getHours()+n);break;case"n":this.setMinutes(this.getMinutes()+n);break;case"s":this.setSeconds(this.getSeconds()+n);break;case"l":this.setMilliseconds(this.getMilliseconds()+n)}return i?this.pattern(i):this};Vue.directive("disabled",function(n,t){t.value?($(n).addClass("layui-disabled"),$(n).attr("disabled",!0)):($(n).removeClass("layui-disabled"),$(n).attr("disabled",!1))});Vue.filter("objEmptyStr",function(n,t){return n?n[t]:""});